<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{/fragments/header :: mainHeader}"><!-- 부트 스트랩 -->
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" th:href="@{/css/auction.css}">
</head>
<body>

<!------------------------------ AUC.ID = SESSION.ID면 유저 / SESSION.ID.STATE=2 이면 헬퍼  ---------------------------->
<!------------------------------ 로그인 값에 따라서 네비게이션 따로 출력   ---------------------------->
<div th:if="${session.user.state == 2}">
    <div th:replace="~{/fragments/navHelper :: naviHelper}"></div>
</div>
<div th:if="${session.user.state != 2 || session.user.id == user.id}">
    <div th:replace="~{/fragments/navUser :: naviUser}"></div>
</div>
<div th:if="${session.user.state != 2 || session.user.id != user.id}">
    <!-- 메인 페이지로 보내는 코드 필요 -->
</div>

<!-- HOME : 위에 회색 그거 -->
<section class="section-hero overlay inner-page bg-image" style="background-image: url('images/hero_1.jpg');"
         id="home-section">
    <div class="container">
        <div class="row">
            <div class="col-md-7">
                <h1 class="text-white font-weight-bold">Auctions</h1>
                <div class="custom-breadcrumbs">
                    <a href="#">미션</a> <span class="mx-2 slash">/</span>
                    <span class="text-white"><strong>미션 상세보기</strong></span>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="site-section">
    <div class="container">
        <div>
            <!----------------------------------------- 유저 정보 : 닉네임 & INTRO-------------------------------------------------------------->
            <div class="box">
                <img th:src="@{user.photo}" alt="User Default" class="img-fluid mb-4 w-50 rounded-circle">
                <h3>[[${user.nickName}]]</h3>
                <p>[[${user.intro}]]</p>
                <div th:if="${session.user.id != auction.user}" class="col-6">
                    <a th:href="@{#}" class="btn btn-block btn-primary btn-md">채팅하기</a><!-- 초록버튼 -->
<!------------------------------------ 채팅하기 연결예정 ---------------------------------------------------------------------------->
                </div>
            </div>

            <!----------------------------------------- 해당 옥션 정보 -------------------------------------------------------------->
            <!-- 기본 정보 -->
            <div class="bg-light p-3 border rounded mb-4">
                <h3 class="text-primary  mt-3 h5 pl-3 mb-3 ">미션 내용</h3>
                <ul class="list-unstyled pl-3 mb-0">
                    <!--카테고리 조건문 출력-->
                    <div th:if="${auction.category == 1}">
                        <li class="mb-2"><strong class="text-black">카테고리:</strong>구매대행</li>
                    </div>
                    <div th:if="${auction.category == 2}">
                        <li class="mb-2"><strong class="text-black">카테고리:</strong>홈케어</li>
                    </div>
                    <div th:if="${auction.category == 3}">
                        <li class="mb-2"><strong class="text-black">카테고리:</strong>펫 케어</li>
                    </div>
                    <div th:if="${auction.category == 4}">
                        <li class="mb-2"><strong class="text-black">카테고리:</strong>퀵 서비스</li>
                    </div>

                    <li class="mb-2"><strong class="text-black">날짜-시간:</strong>[[${#temporals.format(auction.doDateTime,'yyyy/MM/dd
                        - hh:mm')}]]
                    </li>

                    <!---------------------상세주소는 AUC.ID=SESSION.ID일 때만 확인 가능, 그 외는 시도/시군구 출력-------------->
                    <div th:if="${session.user.id == user}">
                        <li class="mb-2"><strong class="text-black">장소:</strong>[[${auction.address}]]</li>
                    </div>
                    <div th:if="${session.user.id != user}">
                        <li class="mb-2"><strong class="text-black">장소:</strong>[[${auction.sido}]]
                            [[${auction.sigungu}]]
                        </li>
                    </div>
                    * 정확한 주소는 낙찰 된 헬퍼에게만 공개 됩니다.

                    <li class="mb-2"><strong class="text-black">시작가:</strong>[[${#numbers.formatInteger(auction.startPrice,3,'COMMA')}]]원
                    </li>
                    <li class="mb-2"><strong class="text-black">경매단위:</strong>[[${#numbers.formatInteger(auction.auctionGap,3,'COMMA')}]]원
                    </li>
                    <li class="mb-2"><strong class="text-black">예상 소요시간:</strong>[[${auction.predictHour}]]분</li>

                    <!-- 난이도 -->
                    <div th:if="${auction.level == 1}">
                        <li class="mb-2"><strong class="text-black">미션난이도:</strong>쉬움</li>
                    </div>
                    <div th:if="${auction.level == 2}">
                        <li class="mb-2"><strong class="text-black">미션난이도:</strong>보통</li>
                    </div>
                    <div th:if="${auction.level == 3}">
                        <li class="mb-2"><strong class="text-black">미션난이도:</strong>어려움</li>
                    </div>

                    <!--우대사항-->
                    <li class="mb-2"><strong class="text-black">우대사항</strong></li>
                    <div th:if="${auction.driverLicense == 0}">
                        <li class="mb-2"><strong class="text-black">운전면허여부:</strong>무관</li>
                    </div>
                    <div th:if="${auction.driverLicense == 1}">
                        <li class="mb-2"><strong class="text-black">운전면허여부:</strong>소지자 선호</li>
                    </div>

                    <div th:if="${auction.gender == 0}">
                        <li class="mb-2"><strong class="text-black">성별:</strong>무관</li>
                    </div>
                    <div th:if="${auction.gender == 1}">
                        <li class="mb-2"><strong class="text-black">성별:</strong>여성</li>
                    </div>
                    <div th:if="${auction.gender == 2}">
                        <li class="mb-2"><strong class="text-black">성별:</strong>남성</li>
                    </div>

                    <div th:if="${auction.age == 0}">
                        <li class="mb-2"><strong class="text-black">나이대:</strong>무관</li>
                    </div>
                    <div th:if="${auction.age == 1}">
                        <li class="mb-2"><strong class="text-black">나이대:</strong>청년층</li>
                    </div>
                    <div th:if="${auction.age == 2}">
                        <li class="mb-2"><strong class="text-black">나이대:</strong>중년층</li>
                    </div>
                    <div th:if="${auction.age == 3}">
                        <li class="mb-2"><strong class="text-black">나이대:</strong>장년층</li>
                    </div>
                </ul>
            </div>
            <!--타이틀 및 콘텐츠 내용-->
            <div class="mb-5">
                <h3 class="h5 d-flex align-items-center mb-4 text-primary"><span class="icon-align-left mr-3"></span>[[${auction.title}]]
                </h3>
                <p>[[${auction.content}]]</p>
            </div>

            <!-- 해당 옥션의 남은 시간 - 버튼타입수정 필 -->
            <h5>남은 시간</h5>
            <div id="timerDemo"></div>

        </div>
        <!-- 옥션정보 끝 -->
        <br>
        <br>

        <!----------------------------------- 해당 옥션 비딩 목록 ------------------------------------------------------->
        <span th:unless="${exist}">아직 경매 참여 내역이 없습니다.</span>

        <div th:if="${exist}">
            <table border="1" class="table">
                <tr>
                    <td> 헬퍼 ID</td>
                    <td> 제시 가격</td>
                    <div th:if="${session.user.id = user.id}">
                    <td> 선택하기</td>
                    </div>
                </tr>
                <!-- 리스트 시작-->
                <tr th:each="dto : ${biddingList.dtoList}">
                    <td><a th:href="@{#}">[[${dto.helper}]]</a></td>
                    <!----------------------------------- 비즈니스 카드로 연결 --------------------------------------------------------------------->
                    <td>[[${dto.offerPrice}]]</td>
                    <!-------------- auc.id = session.id일 경우 선택버튼, 아닐 경우 헬퍼 블로그 보기 ------------------->
                    <td>
                        <button>선택</button>
                    </td> <!-- 선택하면 모달창으로 확인 -->
                </tr>
            </table>
        </div>

        <br><br>

        <!-- AUC.ID = SESSION.ID면 삭제 버튼 / SESSION.ID.STATE=2 이면 참여 버튼  -->
        <button>경매 삭제하기</button>
        <div class="row mb-5">
            <div class="col-6">
                <a href="#" class="btn btn-block btn-light btn-md"><span class="mr-2 text-danger"></span>Save Job</a>
                <!-- 회색버튼 -->
            </div>
            <div class="col-6">
                <a href="#" class="btn btn-block btn-primary btn-md">Apply Now</a><!-- 초록버튼 -->
            </div>
        </div>
    </div>
</section>
<!-- 공통 footer -->
<footer th:replace="~{/fragments/footer :: mainFooter}"></footer>


<!-- 공통 스크립트 -->
<!-- SCRIPTS -->
<script th:src="@{/js/jquery.min.js}"></script>
<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/isotope.pkgd.min.js}"></script>
<script th:src="@{/js/stickyfill.min.js}"></script>
<script th:src="@{/js/jquery.fancybox.min.js}"></script>
<script th:src="@{/js/jquery.easing.1.3.js}"></script>

<script th:src="@{/js/jquery.waypoints.min.js}"></script>
<script th:src="@{/js/jquery.animateNumber.min.js}"></script>
<script th:src="@{/js/owl.carousel.min.js}"></script>
<script th:src="@{/js/quill.min.js}"></script>

<script th:src="@{/js/bootstrap-select.min.js}"></script>

<script th:src="@{/js/custom.js}"></script>
<!--jquery-->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

<!-- 타이머 만들기 -->
<script th:inline="javascript">
	var time = [[${time}]];
	var min = "";
	var sec = "";

	var x = setInterval(function () {
		min = parseInt(time / 60);
		sec = time % 60;
		document.getElementById("timerDemo").innerHTML = min + "분 " + sec + "초";
		time--;

		if (time < 0) {
			clearInterval(x);
			document.getElementById("timerDemo").innerHTML = "경매 완료";
		}

	}, 1000);
</script>

</body>
</html>